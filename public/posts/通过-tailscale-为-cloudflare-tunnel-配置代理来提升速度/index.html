<!DOCTYPE html>
<html lang="en" dir="auto">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="noindex, nofollow">
<title>通过 Tailscale 为 CloudFlare Tunnel 配置代理来提升速度 | WallBreakerNO4的博客</title>
<meta name="keywords" content="">
<meta name="description" content="CloudFlare 为什么被称为云计算领域的神？在讨论这个问题之前，我想先说说其他云服务提供商相较于 CloudFlare 究竟差在了哪里&hellip;
好了，不开玩笑了 (‾◡◝)，但 CloudFlare 确实提供了很多实用且免费的服务给我们这些平民玩家，如免费的 Worker 和 CDN 虽然在国内是减速器，以及本文标题提及的 CloudFlare Tunnel。
CloudFlare Tunnel 是什么 这是官方的产品介绍：官方文章 省流：你可以理解成这是一个类似 frp 的内网穿透服务，你可以将你部署在内网的 http 服务穿透到公网上。不同的是 CloudFlare 在上面集成了 CDN 服务，并且提供了自动 https。最关键的是，只要你将域名托管到 CloudFlare 上，你就可以免费的使用这个服务。
BUT! CloudFlare 在国内访问速度不佳是众所周知的事 CloudFlare 减速器。 同样的道理，由于使用 CloudFlare Tunnel 的先决条件是在内网的机器能访问到 CloudFlare Tunnel Endpoint，然而在国内去访问这些 Endpoint 并不稳定。导致访问速度慢，甚至服务掉线。
因此我想到是否可以通过给 Tunnel 添加前置代理的方法来提升速度与稳定性，在一番搜索之后找到这篇文章。然而文章中指出：CloudFlare 官方的态度是不会支持 HTTP/Socks 前置代理 链接。因此，那篇文章中是使用了 V2ray &#43; IPtables 手写路由达成了透明代理。
受到文章启发，结合本人已经搭建好的 Tailscale 网络">
<meta name="author" content="WallBreakerNO4">
<link rel="canonical" href="http://192.168.20.55:1313/posts/%E9%80%9A%E8%BF%87-tailscale-%E4%B8%BA-cloudflare-tunnel-%E9%85%8D%E7%BD%AE%E4%BB%A3%E7%90%86%E6%9D%A5%E6%8F%90%E5%8D%87%E9%80%9F%E5%BA%A6/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.b609c58d5c11bb90b1a54e04005d74ad1ddf22165eb79f5533967e57df9c3b50.css" integrity="sha256-tgnFjVwRu5CxpU4EAF10rR3fIhZet59VM5Z&#43;V9&#43;cO1A=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://192.168.20.55:1313/assets/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://192.168.20.55:1313/assets/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://192.168.20.55:1313/assets/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://192.168.20.55:1313/assets/apple-touch-icon.png">
<link rel="mask-icon" href="http://192.168.20.55:1313/assets/mstile-150x150.png">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="http://192.168.20.55:1313/posts/%E9%80%9A%E8%BF%87-tailscale-%E4%B8%BA-cloudflare-tunnel-%E9%85%8D%E7%BD%AE%E4%BB%A3%E7%90%86%E6%9D%A5%E6%8F%90%E5%8D%87%E9%80%9F%E5%BA%A6/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
</noscript>
</head>

<body class=" dark" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://192.168.20.55:1313/" accesskey="h" title="WallBreakerNO4的博客 (Alt + H)">WallBreakerNO4的博客</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="http://192.168.20.55:1313/friends/" title="朋友">
                    <span>朋友</span>
                </a>
            </li>
            <li>
                <a href="http://192.168.20.55:1313/about/" title="关于">
                    <span>关于</span>
                </a>
            </li>
            <li>
                <a href="http://192.168.20.55:1313/archives" title="存档">
                    <span>存档</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="http://192.168.20.55:1313/">Home</a>&nbsp;»&nbsp;<a href="http://192.168.20.55:1313/posts/">Posts</a></div>
    <h1 class="post-title entry-hint-parent">
      通过 Tailscale 为 CloudFlare Tunnel 配置代理来提升速度
      <span class="entry-hint" title="Draft">
        <svg xmlns="http://www.w3.org/2000/svg" height="35" viewBox="0 -960 960 960" fill="currentColor">
          <path
            d="M160-410v-60h300v60H160Zm0-165v-60h470v60H160Zm0-165v-60h470v60H160Zm360 580v-123l221-220q9-9 20-13t22-4q12 0 23 4.5t20 13.5l37 37q9 9 13 20t4 22q0 11-4.5 22.5T862.09-380L643-160H520Zm300-263-37-37 37 37ZM580-220h38l121-122-18-19-19-18-122 121v38Zm141-141-19-18 37 37-18-19Z" />
        </svg>
      </span>
    </h1>
    <div class="post-meta"><span title='2024-07-30 16:07:00 +0000 UTC'>July 30, 2024</span>&nbsp;·&nbsp;WallBreakerNO4

</div>
  </header> 
  <div class="post-content"><blockquote>
<p>CloudFlare 为什么被称为云计算领域的神？在讨论这个问题之前，我想先说说其他云服务提供商相较于 CloudFlare 究竟差在了哪里&hellip;</p>
</blockquote>
<p>好了，不开玩笑了 (‾◡◝)，但 CloudFlare 确实提供了很多实用且免费的服务给我们这些平民玩家，如免费的 Worker 和 CDN <del>虽然在国内是减速器</del>，以及本文标题提及的 CloudFlare Tunnel。</p>
<h2 id="cloudflare-tunnel-是什么">CloudFlare Tunnel 是什么<a hidden class="anchor" aria-hidden="true" href="#cloudflare-tunnel-是什么">#</a></h2>
<p>这是官方的产品介绍：<a href="https://www.cloudflare.com/zh-cn/products/tunnel/">官方文章</a>
省流：你可以理解成这是一个类似 frp 的内网穿透服务，你可以将你部署在内网的 http 服务穿透到公网上。不同的是 CloudFlare 在上面集成了 CDN 服务，并且提供了自动 https。最关键的是，只要你将域名托管到 CloudFlare 上，你就可以免费的使用这个服务。</p>
<h3 id="but">BUT!<a hidden class="anchor" aria-hidden="true" href="#but">#</a></h3>
<p>CloudFlare 在国内访问速度不佳是众所周知的事 <del>CloudFlare 减速器</del>。
<img loading="lazy" src="https://image.wall-breaker-no4.xyz/imgs/20240730160252.png#center" alt="image.png"  />

同样的道理，由于使用 CloudFlare Tunnel 的先决条件是在内网的机器能访问到 CloudFlare Tunnel Endpoint，然而在国内去访问这些 Endpoint 并不稳定。导致访问速度慢，甚至服务掉线。</p>
<p>因此我想到是否可以通过给 Tunnel 添加前置代理的方法来提升速度与稳定性，在一番搜索之后找到这篇<a href="https://blog.xmgspace.me/archives/cloudflare-tunnel-via-proxy.html">文章</a>。然而文章中指出：CloudFlare 官方的态度是不会支持 HTTP/Socks 前置代理 <a href="https://github.com/cloudflare/cloudflared/issues/350#issuecomment-1706842883">链接</a>。因此，那篇文章中是使用了 V2ray + IPtables 手写路由达成了透明代理。</p>
<p>受到文章启发，结合本人已经搭建好的 Tailscale 网络</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
    </ul>
<nav class="paginav">
  <a class="next" href="http://192.168.20.55:1313/posts/%E5%9C%A8%E5%AE%89%E5%8D%93%E4%B8%8B%E5%90%8C%E6%97%B6%E4%BD%BF%E7%94%A8-clash-%E5%92%8C-tailscale/">
    <span class="title">Next »</span>
    <br>
    <span>在安卓下同时使用 Clash 和 Tailscale</span>
  </a>
</nav>

  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2024 <a href="http://192.168.20.55:1313/">WallBreakerNO4的博客</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
